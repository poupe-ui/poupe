# @poupe/tailwindcss Package Agent Guidelines

## Build/Lint/Test Commands
- Build: `pnpm build`
- Type check: `pnpm type-check`
- Lint: `pnpm lint`
- Test: `pnpm test`
- Test watch mode: `pnpm dev`
- Development build (stub): `pnpm dev:prepare`
- Clean: `pnpm clean`
- Publish lint check: `pnpm publint`
- Full pre-publish check: `pnpm prepack`

## Code Style Guidelines (.editorconfig)
- Use UTF-8 charset
- Unix line endings (LF)
- Use spaces for indentation in TypeScript/JavaScript/CSS/JSON files (2 spaces)
- Use tabs for other files (8 spaces width)
- Always insert final newline
- Trim trailing whitespace
- Single quotes for strings
- Always use semicolons
- Use 1tbs (one true brace style)
- Follow existing naming patterns (camelCase for variables/functions, PascalCase for types/interfaces)
- Use markdown reference variables for links in documentation

## Package Structure
```
src/
├── assets/           # Generated CSS assets (auto-generated by build)
├── flat/            # Flat configuration plugin
├── theme/           # Core theme system
├── utils/           # Utility functions and plugin helpers
└── index.ts         # Main entry point
```

## Generated Assets
- **src/assets/style.css**: Auto-generated during build from theme configuration
  - Contains @utility directives for components (scrim, surface utilities)
  - Contains CSS custom properties for Material Design 3 colors
  - DO NOT EDIT: Regenerated on every build via build.config.ts
  - Generated by `writeTheme()` function in build.config.ts

## Material Design 3 Z-Index Scale
Use these semantic z-index values for layering:
```css
--md-z-navigation-persistent: 1000;  /* Mobile stepper, bottom navigation */
--md-z-navigation-floating: 1050;    /* FAB, speed dial */
--md-z-navigation-top: 1100;         /* App bar, top navigation */
--md-z-drawer: 1200;                 /* Navigation drawer, side sheets */
--md-z-modal: 1300;                  /* Modal dialogs */
--md-z-snackbar: 1400;               /* Snackbars, toasts */
--md-z-tooltip: 1500;                /* Tooltips */
```

## Scrim Utility System
Scrim overlays with Material Design z-index layering for modal backdrops:

### Utility Classes
- `scrim` - Base scrim without z-index
- `scrim-z-*` - Arbitrary z-index support using `--value(integer, [integer])`

### Semantic Variants
- `scrim-z-base` (950) - Basic overlay, below navigation
- `scrim-z-content` (975) - Content overlay
- `scrim-z-drawer` (1175) - Scrim for drawer overlays
- `scrim-z-modal` (1275) - Scrim for modal preparation
- `scrim-z-elevated` (1350) - High-priority overlays
- `scrim-z-system` (1450) - System-level scrims

### Usage Examples
```html
<div class="scrim-z-modal">Modal backdrop</div>
<div class="scrim-z-[1250]">Custom z-index</div>
<div class="scrim-z-[var(--custom-z)]">CSS variable</div>
```

### Implementation Notes
- Scrims use `fixed inset-0 bg-scrim/32` for full viewport coverage
- Scrim z-index values are positioned **below** their corresponding components
- Example: `scrim-z-modal` (1275) < `modal` (1300) for proper layering

## Component Development
- Components are defined in `src/theme/components.ts`
- Use `makeThemeComponents()` to register new component utilities
- Components are automatically converted to @utility format via `prepareComponents()`
- Support arbitrary values with `--value(integer, [integer])` syntax
- Example: `scrim-z-*` supports both `scrim-z-10` and `scrim-z-[999]`

## Color System
- **Tailwind Colors**: 25 modern colors (slate, gray/grey, zinc, neutral,
  stone, red, orange, amber, yellow, lime, green, emerald, teal, cyan,
  sky, blue, indigo, violet, purple, fuchsia, pink, rose, black, white)
- **CSS Named Colors**: 149 CSS specification colors as fallback
- **Priority Order**: Tailwind colors override CSS named colors
- **British Spelling**: `grey` alias points to same value as `gray`
- **Color Resolution**: `withKnownColor()` function handles precedence

## Theme System
- Colors: Material Design 3 color tokens with automatic dark mode
- Shadows: Elevation-based shadow system (z1-z5)
- Surface utilities: Automatic background/text color pairing
- Scrim utilities: Modal backdrop overlays with z-index layering
- CSS variables: All values exposed as CSS custom properties

## Testing
- Unit tests in `src/**/__tests__/` directories
- Test theme generation, plugin functionality, utilities, and colors
- Use Vitest for testing framework
- Run specific test: `pnpm vitest run src/path/to/file.test.ts`
- Color tests: `pnpm test src/theme/__tests__/default-colors.test.ts`

## Dependencies
- **Runtime**: `@poupe/css`, `@poupe/theme-builder`, `type-fest`
- **Peer**: `tailwindcss@^4.1`
- **Build**: TypeScript, Unbuild, Vitest, ESLint

## Common Tasks
1. **Adding new utility**: Modify `src/theme/components.ts` → run `pnpm build`
2. **Updating theme**: Modify theme types/options → run `pnpm build`
3. **Testing changes**: `pnpm dev` (watch mode) or `pnpm test` (single run)
4. **Type checking**: `pnpm type-check`
5. **Linting**: `pnpm lint` (auto-fixes issues)

## Build Process
1. Unbuild's `build:prepare` hook generates `src/assets/style.css` from theme configuration.
2. Unbuild compiles TypeScript and bundles modules
3. Outputs: `dist/index.mjs`, `dist/theme.mjs`, `dist/utils.mjs`, `dist/style.css`
4. Type definitions generated automatically
